/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TableCheckboxesPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var TableCheckboxesPlugin = class extends import_obsidian.Plugin {
  loadView() {
  }
  async onload() {
    let view = null;
    this.app.workspace.onLayoutReady(() => view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView));
    this.registerDomEvent(document, "keyup", (evt) => {
      if (evt.key == "]" && view) {
        const location = view.editor.getCursor("anchor");
        const rowValue = view.editor.getLine(location.line);
        if (this.isMDCheckboxInTable(rowValue)) {
          const checkBox = this.getCheckboxLength(rowValue);
          if (checkBox) {
            const start = { ...location };
            start.ch -= checkBox[0].length;
            view.editor.setSelection(start, location);
            view.editor.replaceSelection('<input type="checkbox" unchecked> ');
          }
        }
      }
    });
    this.registerDomEvent(document, "change", (evt) => {
      if (evt.target instanceof HTMLInputElement && view && evt.target.hasAttribute("data-task") == false) {
        const checkbox = evt.target;
        if (checkbox.getAttribute("type") == "checkbox") {
          let page = view.getViewData();
          if (this.isHTMLCheckboxInTable(page)) {
            const table = this.findTableInPath(evt);
            const allTables = this.getAllTables(page);
            const tableLoc = this.getTableLocation(page, allTables, table);
            const cellLoc = this.getCellLocation(evt, tableLoc);
            this.toggleCheckbox(page, view, checkbox, cellLoc);
          }
        }
      }
    });
  }
  onunload() {
  }
  getAllTables(page) {
    const tableHeaderRegex = /(?<=(\n){2}|^)([^\r\n]*\|[^\r\n]*(\r?\n)?)+(?=(\r?\n){2}|$)/gm;
    const allTables = page.match(tableHeaderRegex);
    return allTables;
  }
  getTableLocation(page, allTables, table) {
    let tableInFile;
    allTables.forEach((mdTable) => {
      const htmlValues = (0, import_obsidian.htmlToMarkdown)(table).split("\n").map((element) => {
        return element.trim().replace("-", "").replace("\\", "|").replace(/\s/g, "");
      }).filter((element) => {
        return element !== "";
      });
      const mdValues = mdTable.split("|").map((element) => {
        return element.trim().replace('<input type="checkbox" checked>', "").replace('<input type="checkbox" unchecked>', "").replace("\\", "|").replace(/\s/g, "");
      }).filter((element) => {
        return element !== "" && element !== "\n" && element.match(new RegExp("[^-]"));
      });
      let result = true;
      for (let i = 0; i < htmlValues.length; i++) {
        if (htmlValues[i] !== mdValues[i]) {
          result = false;
          break;
        }
      }
      if (result) {
        tableInFile = mdTable;
      }
    });
    const rowNumber = page.split("\n").indexOf(tableInFile.split("\n")[0]);
    return rowNumber;
  }
  getCellLocation(evt, rowNumber) {
    try {
      const columnIndex = evt.composedPath().find((td) => td.nodeName.toLowerCase() === "td").cellIndex + 1;
      const rowIndex = evt.composedPath().find((tr) => tr.nodeName.toLowerCase() === "tr").rowIndex + rowNumber + 1;
      return [rowIndex, columnIndex];
    } catch (error) {
      const columnIndex = evt.composedPath().find((th) => th.nodeName.toLowerCase() === "th").cellIndex + 1;
      const rowIndex = evt.composedPath().find((tr) => tr.nodeName.toLowerCase() === "tr").rowIndex + rowNumber;
      return [rowIndex, columnIndex];
    }
  }
  findTableInPath(evt) {
    const path = evt.composedPath();
    const table = path.find((table2) => table2.nodeName.toLowerCase() === "table");
    return table;
  }
  isMDCheckboxInTable(row) {
    const tableRegex = /\|[\s]*-[\s]?\[[\s]?\].*\|/;
    if (row.match(tableRegex)) {
      return true;
    }
    return false;
  }
  isHTMLCheckboxInTable(row) {
    const tableRegex = /\|[\s]*<input type="checkbox" (un)?checked>.*\|/;
    if (row.match(tableRegex)) {
      return true;
    }
    return false;
  }
  getCheckboxLength(row) {
    const checkboxRegex = /-[\s]?[[\s]?]/;
    const checkBox = row.match(checkboxRegex);
    return checkBox;
  }
  toggleCheckbox(page, view, checkbox, cellLoc) {
    const columnRegex = /(?<!\\)\|/g;
    let lines = page.split("\n");
    let row = lines[cellLoc[0]];
    const cells = row.split(columnRegex);
    if (checkbox.checked) {
      cells[cellLoc[1]] = cells[cellLoc[1]].replace('<input type="checkbox" unchecked>', '<input type="checkbox" checked>');
    } else {
      cells[cellLoc[1]] = cells[cellLoc[1]].replace('<input type="checkbox" checked>', '<input type="checkbox" unchecked>');
    }
    row = cells.join("|");
    lines[cellLoc[0]] = row;
    this.app.vault.modify(view.file, lines.join("\n"));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgaHRtbFRvTWFya2Rvd24sIE1hcmtkb3duVmlldywgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYWJsZUNoZWNrYm94ZXNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRsb2FkVmlldygpIHtcblx0XHRcblx0fVxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0XG5cdFx0bGV0IHZpZXc6IGFueSA9IG51bGw7XG5cblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KSk7XG5cblx0XHQvLyBBZGQgZXZlbnQgbGlzdGVuZXIgdG8gcmVwbGFjZSAnLVtdJyB3aXRoIEhUTUwgY2hlY2tib3ggaW5zaWRlIGEgdGFibGUuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAna2V5dXAnLCAoZXZ0OiBLZXlib2FyZEV2ZW50KSA9PiB7XG5cdFx0XHQvLyBDaGVjayBpZiBubyBhbHQgb3IgY3RybCBrZXk/IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FbGVtZW50L2tleWRvd25fZXZlbnRcblx0XHRcdGlmIChldnQua2V5ID09IFwiXVwiICYmIHZpZXcpIHtcblx0XHRcdFx0Y29uc3QgbG9jYXRpb24gPSB2aWV3LmVkaXRvci5nZXRDdXJzb3IoXCJhbmNob3JcIik7XG5cdFx0XHRcdGNvbnN0IHJvd1ZhbHVlID0gdmlldy5lZGl0b3IuZ2V0TGluZShsb2NhdGlvbi5saW5lKTtcblx0XHRcdFx0aWYgKHRoaXMuaXNNRENoZWNrYm94SW5UYWJsZShyb3dWYWx1ZSkpIHtcblx0XHRcdFx0XHRjb25zdCBjaGVja0JveCA9IHRoaXMuZ2V0Q2hlY2tib3hMZW5ndGgocm93VmFsdWUpO1x0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoY2hlY2tCb3gpIHtcblx0XHRcdFx0XHRcdGNvbnN0IHN0YXJ0ID0gey4uLmxvY2F0aW9ufTsgLy8gU2hhbGxvdyBjb3B5XG5cdFx0XHRcdFx0XHRzdGFydC5jaCAtPSBjaGVja0JveFswXS5sZW5ndGg7IC8vIFN1YnRyYWN0IHRoZSBsZW5ndGggZnJvbSB0aGUgbG9jYXRpb24gb2YgJ10nXG5cdFx0XHRcdFx0XHR2aWV3LmVkaXRvci5zZXRTZWxlY3Rpb24oc3RhcnQsIGxvY2F0aW9uKTsgLy8gU2VsZWN0ICctW10nXG5cdFx0XHRcdFx0XHR2aWV3LmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgdW5jaGVja2VkPiAnKTsgLy8gUmVwbGFjZSBzZWxlY3Rpb24gd2l0aCB1bmNoZWNrZWQgSFRNTCBjaGVja2JveFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVx0XHRcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJjaGFuZ2VcIiwgKGV2dDogSW5wdXRFdmVudCkgPT4ge1xuXHRcdFx0Ly8gQ2hlY2sgZm9yIGRhdGEtdGFzayBhdHRyaWJ1dGUgdG8gaWdub3JlIG1hcmtkb3duIGNoZWNrYm94ZXNcblx0XHRcdGlmIChldnQudGFyZ2V0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJiB2aWV3ICYmIGV2dC50YXJnZXQuaGFzQXR0cmlidXRlKFwiZGF0YS10YXNrXCIpID09IGZhbHNlKSB7XG5cdFx0XHRcdGNvbnN0IGNoZWNrYm94ID0gZXZ0LnRhcmdldFxuXHRcdFx0XHRpZiAoY2hlY2tib3guZ2V0QXR0cmlidXRlKFwidHlwZVwiKSA9PSBcImNoZWNrYm94XCIpIHtcblx0XHRcdFx0XHRsZXQgcGFnZSA9IHZpZXcuZ2V0Vmlld0RhdGEoKTtcblx0XHRcdFx0XHRpZiAodGhpcy5pc0hUTUxDaGVja2JveEluVGFibGUocGFnZSkpIHtcblx0XHRcdFx0XHRcdGNvbnN0IHRhYmxlID0gdGhpcy5maW5kVGFibGVJblBhdGgoZXZ0KTtcblx0XHRcdFx0XHRcdGNvbnN0IGFsbFRhYmxlcyA9IHRoaXMuZ2V0QWxsVGFibGVzKHBhZ2UpO1xuXHRcdFx0XHRcdFx0Y29uc3QgdGFibGVMb2MgPSB0aGlzLmdldFRhYmxlTG9jYXRpb24ocGFnZSwgYWxsVGFibGVzISwgdGFibGUpO1xuXHRcdFx0XHRcdFx0Y29uc3QgY2VsbExvYyA9IHRoaXMuZ2V0Q2VsbExvY2F0aW9uKGV2dCwgdGFibGVMb2MpO1xuXHRcdFx0XHRcdFx0dGhpcy50b2dnbGVDaGVja2JveChwYWdlLCB2aWV3LCBjaGVja2JveCwgY2VsbExvYyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSlcblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXG5cdH1cblxuXHQvLyBHZXRzIGFsbCBtYXJrZG93biB0YWJsZXMgaW4gdGhlIGZpbGUgdG8gbG9vcCBvdmVyIGFuZCBjb21wYXJlIHRvIEhUTUwgdGFibGVcblx0Ly8gVGhlIG1vc3QgcGFpbmZ1bCByZWdleCBJJ3ZlIGV2ZXIgaGFkIHRoZSBkaXNwbGVhc3VyZSBvZiBkZWFsaW5nIHdpdGguXG5cdC8vIE1hc3NpdmUgdGhhbmtzIHRvIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMjcyMzcxMSwgYWxsIEkgaGFkIHRvIGRvIHdhc1xuXHQvLyByZW1vdmUgdGhlIGZpcnN0ICcvcj8nIGFuZCBpdCB3b3JrZWQuXG5cdHByaXZhdGUgZ2V0QWxsVGFibGVzKHBhZ2U6IHN0cmluZykge1xuXHRcdGNvbnN0IHRhYmxlSGVhZGVyUmVnZXggPSAvKD88PShcXG4pezJ9fF4pKFteXFxyXFxuXSpcXHxbXlxcclxcbl0qKFxccj9cXG4pPykrKD89KFxccj9cXG4pezJ9fCQpL2dtO1xuXHRcdGNvbnN0IGFsbFRhYmxlcyA9IHBhZ2UubWF0Y2godGFibGVIZWFkZXJSZWdleCk7XG5cdFx0cmV0dXJuIGFsbFRhYmxlcztcblx0fVxuXG5cdC8vIEdldHMgdGhlIHJvdyB3aGljaCB0aGUgdGFibGUgaXMgb24gYnkgZ2V0dGluZyB0aGUgdmFsdWVzIGZyb20gZXZlcnkgY2VsbC5cblx0Ly8gR2V0cyByaWQgb2YgZW1wdHkvd2hpdGVzcGFjZSBvbmx5IGNlbGxzLCBjZWxscyB3aXRoIG9ubHkgZGFzaGVzIGFuZFxuXHQvLyByZXBsYWNlIGVuY29kZWQgcGlwZXMgd2l0aCBub3JtYWwgb25lcy5cblx0Ly8gQ29tcGFyZXMgYWxsIHRoZSBsZWZ0b3ZlciB2YWx1ZXMgKHB1cmUgdGV4dCwgbm8gd2hpdGVzcGFjZSkuXG5cdC8vIElmIHRoZXkgYWxsIG1hdGNoLCB0aGUgY29ycmVjdCB0YWJsZSBpcyBmb3VuZCBhbmQgd2UgZmluZCBpdHMgcm93IGluZGV4IGluIHRoZSBmaWxlLlxuXHQvLyBEZWZpbml0ZWx5IGNvdWxkIGJlIHVuaGFuZGxlZCBlZGdlY2FzZXMuIFBsZWFzZSBvcGVuIGFuIGlzc3VlIG9yIFBSIVxuXHQvLyBJdCBhbHNvIHByb2JhYmx5IGRvZXNuJ3Qgd29yayBcblx0cHJpdmF0ZSBnZXRUYWJsZUxvY2F0aW9uKHBhZ2U6IHN0cmluZywgYWxsVGFibGVzOiBSZWdFeHBNYXRjaEFycmF5LCB0YWJsZTogc3RyaW5nKTogTnVtYmVyIHtcblx0XHRsZXQgdGFibGVJbkZpbGU6IHN0cmluZztcblxuXHRcdGFsbFRhYmxlcy5mb3JFYWNoKChtZFRhYmxlKSA9PiB7XG5cdFx0XHRjb25zdCBodG1sVmFsdWVzID0gaHRtbFRvTWFya2Rvd24odGFibGUpLnNwbGl0KFwiXFxuXCIpLm1hcChlbGVtZW50ID0+IHtcblx0XHRcdFx0Ly8gSGFuZGxpbmcgZWRnZWNhc2VzIGlzIG5vdCBwcmV0dHlcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQudHJpbSgpLnJlcGxhY2UoXCItXCIsXCJcIikucmVwbGFjZShcIlxcXFxcIixcInxcIikucmVwbGFjZSgvXFxzL2csXCJcIik7XG5cdFx0XHR9KS5maWx0ZXIoZWxlbWVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBlbGVtZW50ICE9PSBcIlwiO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IG1kVmFsdWVzID0gbWRUYWJsZS5zcGxpdChcInxcIikubWFwKGVsZW1lbnQgPT4ge1xuXHRcdFx0XHQvLyBFdmVuIG1vcmUgZWRnZWNhc2VzIGR1ZSB0byBjaGFyIGVuY29kaW5nXG5cdFx0XHRcdHJldHVybiBlbGVtZW50LnRyaW0oKS5yZXBsYWNlKFwiPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBjaGVja2VkPlwiLFwiXCIpLnJlcGxhY2UoXCI8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIHVuY2hlY2tlZD5cIixcIlwiKS5yZXBsYWNlKFwiXFxcXFwiLFwifFwiKS5yZXBsYWNlKC9cXHMvZyxcIlwiKTtcblx0XHRcdH0pLmZpbHRlcihlbGVtZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQgIT09IFwiXCIgJiYgZWxlbWVudCAhPT0gXCJcXG5cIiAmJiBlbGVtZW50Lm1hdGNoKG5ldyBSZWdFeHAoXCJbXi1dXCIpKTtcblx0XHRcdH0pXG5cdFx0XHRcblx0XHRcdGxldCByZXN1bHQgPSB0cnVlO1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBodG1sVmFsdWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmIChodG1sVmFsdWVzW2ldICE9PSBtZFZhbHVlc1tpXSkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQpIHtcblx0XHRcdFx0dGFibGVJbkZpbGUgPSBtZFRhYmxlXG5cdFx0XHR9XG5cdFx0fSlcblxuXHRcdGNvbnN0IHJvd051bWJlciA9IHBhZ2Uuc3BsaXQoXCJcXG5cIikuaW5kZXhPZih0YWJsZUluRmlsZSEuc3BsaXQoXCJcXG5cIilbMF0pO1xuXHRcdHJldHVybiByb3dOdW1iZXI7XG5cdH1cblxuXHQvLyBHZXRzIHRoZSByb3cgaW4gdGhlIGZpbGUsIGFuZCBjb2x1bW4gaW4gdGFibGUuXG5cdHByaXZhdGUgZ2V0Q2VsbExvY2F0aW9uKGV2dDogSW5wdXRFdmVudCwgcm93TnVtYmVyOiBOdW1iZXIpIHtcblx0XHR0cnkgeyAvLyBJZiB0aGUgY2hlY2tib3ggaXMgaW4gYSByb3cgKGJlbG93IHNlcGFyYXRvcilcblx0XHRcdGNvbnN0IGNvbHVtbkluZGV4ID0gZXZ0LmNvbXBvc2VkUGF0aCgpLmZpbmQodGQgPT4gdGQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0ZFwiKSEuY2VsbEluZGV4KzEgLy8gKzEgdG8gYWNjb3VudCBmb3IgZW1wdHkgc3RyaW5nXG5cdFx0XHRjb25zdCByb3dJbmRleCA9IGV2dC5jb21wb3NlZFBhdGgoKS5maW5kKHRyID0+IHRyLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwidHJcIikhLnJvd0luZGV4K3Jvd051bWJlcisxOyAvLyArMSB0byBhY2NvdW50IGZvciB0aGUgc2VwYXJhdG9yLCArcm93TnVtYmVyIHRvIGFjY291bnQgZm9yIHRhYmxlIGxvY2F0aW9uIGluIGZpbGVcblx0XHRcdHJldHVybiBbcm93SW5kZXgsIGNvbHVtbkluZGV4XVxuXHRcdH1cblx0XHRjYXRjaCAoZXJyb3IpIHsgLy8gSWYgdGhlIGNoZWNrYm94IGlzIGluIHRoZSBoZWFkZXIgKGFib3ZlIHNlcGFyYXRvcilcblx0XHRcdGNvbnN0IGNvbHVtbkluZGV4ID0gZXZ0LmNvbXBvc2VkUGF0aCgpLmZpbmQodGggPT4gdGgubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0aFwiKSEuY2VsbEluZGV4KzEgLy8gKzEgdG8gYWNjb3VudCBmb3IgZW1wdHkgc3RyaW5nXG5cdFx0XHRjb25zdCByb3dJbmRleCA9IGV2dC5jb21wb3NlZFBhdGgoKS5maW5kKHRyID0+IHRyLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwidHJcIikhLnJvd0luZGV4K3Jvd051bWJlcjsgLy8gK3Jvd051bWJlciB0byBhY2NvdW50IGZvciB0YWJsZSBsb2NhdGlvbiBpbiBmaWxlXG5cdFx0XHRyZXR1cm4gW3Jvd0luZGV4LCBjb2x1bW5JbmRleF1cblx0XHR9IFxuXHR9XG5cblx0Ly8gU2ltcGx5IHJldHVybnMgdGhlIDx0YWJsZT48L3RhYmxlPiBhcyBhbiBIVE1MRWxlbWVudCB0byB1c2UgbGF0ZXIuXG5cdHByaXZhdGUgZmluZFRhYmxlSW5QYXRoKGV2dDogSW5wdXRFdmVudCkge1xuXHRcdGNvbnN0IHBhdGggPSBldnQuY29tcG9zZWRQYXRoKCk7XG5cdFx0Y29uc3QgdGFibGUgPSBwYXRoLmZpbmQodGFibGUgPT4gdGFibGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0YWJsZVwiKTtcblx0XHRyZXR1cm4gdGFibGU7XG5cdH1cblxuXHRwcml2YXRlIGlzTURDaGVja2JveEluVGFibGUocm93OiBzdHJpbmcpOiBib29sZWFuIHtcblx0XHQvLyBSZWdleCB0byBjaGVjayBpZiBtYXJrZG93biBjaGVja2JveCBpcyBpbnNpZGUgdGFibGVcblx0XHRjb25zdCB0YWJsZVJlZ2V4ID0gL1xcfFtcXHNdKi1bXFxzXT9cXFtbXFxzXT9cXF0uKlxcfC87XG5cdFx0aWYgKHJvdy5tYXRjaCh0YWJsZVJlZ2V4KSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgaXNIVE1MQ2hlY2tib3hJblRhYmxlKHJvdzogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gUmVnZXggdG8gY2hlY2sgaWYgSFRNTCBjaGVja2JveCBpcyBpbnNpZGUgdGFibGVcblx0XHRjb25zdCB0YWJsZVJlZ2V4ID0gL1xcfFtcXHNdKjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiAodW4pP2NoZWNrZWQ+LipcXHwvO1xuXHRcdGlmIChyb3cubWF0Y2godGFibGVSZWdleCkpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvLyBBbGxvdyBmb3IgZGlmZmVyZW50IGFtb3VudHMgb2Ygd2hpdGVzcGFjZVxuXHRwcml2YXRlIGdldENoZWNrYm94TGVuZ3RoKHJvdzogc3RyaW5nKSB7XG5cdFx0Y29uc3QgY2hlY2tib3hSZWdleCA9IC8tW1xcc10/W1tcXHNdP10vXG5cdFx0Y29uc3QgY2hlY2tCb3ggPSByb3cubWF0Y2goY2hlY2tib3hSZWdleCk7XG5cdFx0cmV0dXJuIGNoZWNrQm94XG5cdH1cblxuXHQvLyBTcGxpdCBwYWdlIGludG8gcm93cywgdGFrZSB0aGUgY29ycmVjdCByb3cgYW5kXG5cdC8vIGNoYW5nZSB0aGUgY2hlY2tib3ggc3RhdGUuIFRoZW4gd3JpdGUgdG8gZmlsZS5cblx0cHJpdmF0ZSB0b2dnbGVDaGVja2JveChwYWdlOiBzdHJpbmcsIHZpZXc6IE1hcmtkb3duVmlldywgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQsIGNlbGxMb2M6IG51bWJlcltdKSB7XG5cdFx0Ly8gY29uc29sZS5sb2cocGFnZSk7XG5cblx0XHRjb25zdCBjb2x1bW5SZWdleCA9IC8oPzwhXFxcXClcXHwvZztcblx0XHRsZXQgbGluZXMgPSBwYWdlLnNwbGl0KFwiXFxuXCIpO1xuXHRcdGxldCByb3cgPSBsaW5lc1tjZWxsTG9jWzBdXTtcblxuXHRcdGNvbnN0IGNlbGxzID0gcm93LnNwbGl0KGNvbHVtblJlZ2V4KTtcblx0XHRpZiAoY2hlY2tib3guY2hlY2tlZCkge1xuXHRcdFx0Y2VsbHNbY2VsbExvY1sxXV0gPSBjZWxsc1tjZWxsTG9jWzFdXS5yZXBsYWNlKCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgdW5jaGVja2VkPicsICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2hlY2tlZD4nKTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRjZWxsc1tjZWxsTG9jWzFdXSA9IGNlbGxzW2NlbGxMb2NbMV1dLnJlcGxhY2UoJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjaGVja2VkPicsICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgdW5jaGVja2VkPicpXG5cdFx0fVxuXHRcdHJvdyA9IGNlbGxzLmpvaW4oXCJ8XCIpO1xuXHRcdGxpbmVzW2NlbGxMb2NbMF1dID0gcm93O1xuXHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeSh2aWV3LmZpbGUsIGxpbmVzLmpvaW4oXCJcXG5cIikpO1xuXHR9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUFxRDtBQUVyRCxJQUFxQix3QkFBckIsY0FBbUQsdUJBQU87QUFBQSxFQUN6RCxXQUFXO0FBQUEsRUFFWDtBQUFBLEVBQ0EsTUFBTSxTQUFTO0FBRWQsUUFBSSxPQUFZO0FBRWhCLFNBQUssSUFBSSxVQUFVLGNBQWMsTUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw0QkFBWSxDQUFDO0FBR2xHLFNBQUssaUJBQWlCLFVBQVUsU0FBUyxDQUFDLFFBQXVCO0FBRWhFLFVBQUksSUFBSSxPQUFPLE9BQU8sTUFBTTtBQUMzQixjQUFNLFdBQVcsS0FBSyxPQUFPLFVBQVUsUUFBUTtBQUMvQyxjQUFNLFdBQVcsS0FBSyxPQUFPLFFBQVEsU0FBUyxJQUFJO0FBQ2xELFlBQUksS0FBSyxvQkFBb0IsUUFBUSxHQUFHO0FBQ3ZDLGdCQUFNLFdBQVcsS0FBSyxrQkFBa0IsUUFBUTtBQUNoRCxjQUFJLFVBQVU7QUFDYixrQkFBTSxRQUFRLEVBQUMsR0FBRyxTQUFRO0FBQzFCLGtCQUFNLE1BQU0sU0FBUyxHQUFHO0FBQ3hCLGlCQUFLLE9BQU8sYUFBYSxPQUFPLFFBQVE7QUFDeEMsaUJBQUssT0FBTyxpQkFBaUIsb0NBQW9DO0FBQUEsVUFDbEU7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUVELFNBQUssaUJBQWlCLFVBQVUsVUFBVSxDQUFDLFFBQW9CO0FBRTlELFVBQUksSUFBSSxrQkFBa0Isb0JBQW9CLFFBQVEsSUFBSSxPQUFPLGFBQWEsV0FBVyxLQUFLLE9BQU87QUFDcEcsY0FBTSxX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
